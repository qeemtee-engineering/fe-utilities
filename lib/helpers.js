!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("moment"),require("spacetime"),require("moment-timezone")):"function"==typeof define&&define.amd?define(["moment","spacetime","moment-timezone"],e):"object"==typeof exports?exports["fe-utilities"]=e(require("moment"),require("spacetime"),require("moment-timezone")):t["fe-utilities"]=e(t.moment,t.spacetime,t["moment-timezone"])}(global,(function(t,e,n){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=9)}([function(t,e){t.exports=require("lodash/get")},function(t,e,n){"use strict";n.r(e);var r={RESERVED:{val:0,title:"Reserved"},PAYMENT_CONFIRMED:{val:1,title:"Confirmed"},PAYMENT_DECLINED:{val:2,title:"Declined"},BOOKING_EXPIRED:{val:3,title:"Expired"},BOOKING_RESCHEDULED:{val:4,title:"Rescheduled"},BOOKING_CANCELLED:{val:5,title:"Cancelled"},BOOKING_IN_PROGRESS:{val:6,title:"In Progress"},BOOKING_COMPLETED:{val:7,title:"Completed"},PAYMENT_REFUNDED:{val:8,title:"Refunded"},AWAITING_GATEWAY_PAYMENT:{val:9,title:"Awaiting Gateway Payment"},RECONCILIATION_PENDING:{val:10,title:"Reconciliation Pending"},PAYMENT_RECONCILED_HOST:{val:11,title:"Reconciled Host"},PAYMENT_RECONCILED_MERCHANT:{val:12,title:"Reconciled Merchant"},PAYMENT_RECONCILED:{val:13,title:"Reconciled"},AWAITING_HOST_PAYMENT:{val:14,title:"Awaiting Host Payment"},PENDING_HOST_PAYMENT_VERIFICATION:{val:15,title:"Pending Host Payment Verification"},HOST_PAYMENT_RECEIVED:{val:16,title:"Host Payment Received"},MERCHANT_AWAITING_PAYMENT:{val:17,title:"Merchant Awaiting Payment"},MERCHANT_PAYMENT_SENT:{val:18,title:"Merchant Payment Sent"},PENDING_SETTLEMENT:{val:19,title:"Pending Settlement"},PENDING_CONFIRMATION:{val:20,title:"Pending Confirmation"},SETTLEMENT_COMPLETE:{val:21,title:"Settlement Complete"},INVOICE_RAISED:{val:22,title:"Invoice Raised"}},o=[r.RESERVED,r.PAYMENT_CONFIRMED,r.PAYMENT_DECLINED,r.BOOKING_EXPIRED,r.BOOKING_RESCHEDULED,r.BOOKING_CANCELLED,r.BOOKING_IN_PROGRESS,r.BOOKING_COMPLETED,r.PAYMENT_REFUNDED,r.AWAITING_HOST_PAYMENT,r.PENDING_SETTLEMENT,r.PENDING_CONFIRMATION,r.SETTLEMENT_COMPLETE,r.INVOICE_RAISED],i=[r.RESERVED,r.PAYMENT_CONFIRMED,r.PAYMENT_DECLINED,r.BOOKING_EXPIRED,r.BOOKING_RESCHEDULED,r.BOOKING_CANCELLED,r.BOOKING_IN_PROGRESS,r.BOOKING_COMPLETED,r.PAYMENT_REFUNDED,r.AWAITING_HOST_PAYMENT,r.PENDING_SETTLEMENT,r.PENDING_CONFIRMATION,r.SETTLEMENT_COMPLETE,r.INVOICE_RAISED],a=[r.PAYMENT_CONFIRMED,r.PAYMENT_DECLINED,r.BOOKING_RESCHEDULED,r.BOOKING_CANCELLED,r.BOOKING_IN_PROGRESS,r.BOOKING_COMPLETED,r.PAYMENT_REFUNDED,r.AWAITING_HOST_PAYMENT,r.PENDING_SETTLEMENT,r.PENDING_CONFIRMATION,r.SETTLEMENT_COMPLETE,r.INVOICE_RAISED],u={TIER_ADULT:"adult",TIER_CHILDREN:"children",TIER_SENIOR_CITIZEN:"seniorCitizen",TIER_MILITARY:"military",TIER_INFANT:"infant",TIER_MINOR:"minor"},c=[-1,1,0,2,3,4];n.d(e,"BOOKING_STATUSES",(function(){return r})),n.d(e,"ADMIN_BOOKING_FILTER_STATUSES",(function(){return o})),n.d(e,"HOST_BOOKING_FILTER_STATUSES",(function(){return i})),n.d(e,"MERCHANT_BOOKING_FILTER_STATUSES",(function(){return a})),n.d(e,"PRICING_TIER",(function(){return u})),n.d(e,"COMMISSION_MIN",(function(){return 10})),n.d(e,"COMMISSION_MAX",(function(){return 30})),n.d(e,"HOST_COMMISSION_MIN",(function(){return 50})),n.d(e,"HOST_COMMISSION_MAX",(function(){return 100})),n.d(e,"DMC_COMMISSION_MIN",(function(){return 0})),n.d(e,"DMC_COMMISSION_MAX",(function(){return 50})),n.d(e,"PROFILE_APPROVAL_STATUS_DRAFT",(function(){return-1})),n.d(e,"PROFILE_APPROVAL_STATUS_AWAITED",(function(){return 0})),n.d(e,"PROFILE_APPROVAL_STATUS_APPROVED",(function(){return 1})),n.d(e,"PROFILE_APPROVAL_STATUS_EDITED",(function(){return 2})),n.d(e,"PROFILE_APPROVAL_STATUS_NEWLY_REJECTED",(function(){return 3})),n.d(e,"PROFILE_APPROVAL_STATUS_CHANGES_REJECTED",(function(){return 4})),n.d(e,"ENUM_PROFILE_APPROVAL_STATUS",(function(){return c}))},function(e,n){e.exports=t},,,function(t,e){t.exports=require("lodash/filter")},function(t,e){t.exports=require("lodash/first")},function(t,n){t.exports=e},function(t,e){t.exports=require("lodash/cloneDeep")},function(t,e,n){"use strict";n.r(e);var r=n(5),o=n.n(r),i=n(6),a=n.n(i),u=n(0),c=n.n(u),l=n(2),E=n.n(l),s=(n(11),n(7)),f=n.n(s),O=n(1);function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T=function(t){var e=a()(o()(O.BOOKING_STATUSES,(function(e){return e.val==t})));return c()(e,"title","")},I=function(t){var e="";return t.forEach((function(t){e+="&status=".concat(t.val)})),e},_=function(t){var e=t.dayINeed,n=t.offset;return E()().utcOffset(n).isoWeekday()<=e?E()().utcOffset(n).isoWeekday(e):E()().utcOffset(n).add(1,"weeks").isoWeekday(e)},S=function(t){var e=!0;return t.statusHistory.forEach((function(t){t.status===O.BOOKING_STATUSES.PAYMENT_CONFIRMED.val&&(e=!1)})),t.status!==O.BOOKING_STATUSES.PAYMENT_CONFIRMED.val&&t.status!==O.BOOKING_STATUSES.BOOKING_EXPIRED.val&&t.status!==O.BOOKING_STATUSES.BOOKING_COMPLETED.val&&t.status!==O.BOOKING_STATUSES.PENDING_SETTLEMENT.val&&t.status!==O.BOOKING_STATUSES.PENDING_CONFIRMATION.val&&t.status!==O.BOOKING_STATUSES.BOOKING_CANCELLED.val||(e=!1),e},A=function(t){return!![O.BOOKING_STATUSES.BOOKING_RESCHEDULED.val,O.BOOKING_STATUSES.BOOKING_IN_PROGRESS.val,O.BOOKING_STATUSES.PAYMENT_CONFIRMED.val].includes(t.status)},m=function(t){return!(t.status<O.BOOKING_STATUSES.PAYMENT_CONFIRMED.val)&&((t.status!==O.BOOKING_STATUSES.BOOKING_CANCELLED.val||!t.payment.hostCashData)&&!![O.BOOKING_STATUSES.BOOKING_RESCHEDULED.val,O.BOOKING_STATUSES.BOOKING_IN_PROGRESS.val,O.BOOKING_STATUSES.PAYMENT_CONFIRMED.val,O.BOOKING_STATUSES.PENDING_SETTLEMENT.val].includes(t.status))},M=function(t){var e=c()(t,"slot.rescheduledSlot");if(t.status!==O.BOOKING_STATUSES.PAYMENT_CONFIRMED.val||e)return!1;if(c()(t,"slot.rescheduleHrs.isAllowed")){var n=E()(t.slot.startTime),r=E()();return E.a.duration(n.diff(r)).asHours()>t.slot.rescheduleHrs.hrs}return!1},D=function(t){if(t.status===O.BOOKING_STATUSES.BOOKING_CANCELLED.val&&t.payment.hostCashData)return!0;if(t.status!==O.BOOKING_STATUSES.PAYMENT_CONFIRMED.val)return!1;if(c()(t,"slot.cancellationHrs.isAllowed")){var e=E()(t.slot.startTime),n=E()();return E.a.duration(e.diff(n)).asHours()>t.slot.cancellationHrs.hrs}return!1},P=function(t){var e=c()(t,"slot.rescheduledSlot");return!(t.status!==O.BOOKING_STATUSES.BOOKING_IN_PROGRESS.val&&t.status!==O.BOOKING_STATUSES.PENDING_SETTLEMENT.val||e)},p=function(t,e){var n=[],r=["fullDay","halfDay","session"].includes(e.subCategory);function o(t){return t=t.sort((function(t,e){return t.startTimeDate-e.startTimeDate}))}return t.forEach((function(t){var o,i,a,u,l,s,f=E()(t.startTime).tz(t.timezone),O=t.endTime?E()(t.endTime).tz(t.timezone):f.clone().add(Number(t.duration),"hours"),N=(o=f.clone(),i=o.format("DD MMM YYYY"),a=!1,n.forEach((function(t){E()(t.dateToBeDisplayed,"DD MMM YYYY").format("DD MMM YYYY")===i&&(a=t.slots)})),a),d=t.partOfDay?t.partOfDay:null;r&&(u=f,l=t.duration,(s=u.clone()).add(l,"h"),!u.isSame(s,"day"))&&"session"===e.subCategory&&(O=t.endTime?E()(t.endTime).tz(t.timezone):E()(f).add(e.activityTime,"hours").tz(t.timezone));var T={closure:t.closure,timezone:t.timezone,startTimeDate:f.clone(),startTime:c()(e,"pickUp.isAvailable")?"".concat(f.format("hh:mm a")," - ").concat(f.add("30","minutes").format("hh:mm a")):f.format("hh:mm a"),endTime:c()(e,"pickUp.isAvailable")?"".concat(O.format("hh:mm a")," - ").concat(O.add("30","minutes").format("hh:mm a")):O.format("hh:mm a"),slotId:t.id,partOfDay:d,maxSeats:t.maxSeats,minSeats:t.availableSeats&&t.availableSeats>t.minSeats?t.minSeats:null,availableSeats:t.availableSeats,rescheduleHrs:t.rescheduleHrs,cancellationHrs:t.cancellationHrs};N?N.push(T):n.push({dateToBeDisplayed:f.format("DD MMM 'YY"),activityId:t.activityId,slots:[T]})})),(n=n.sort((function(t,e){return E()(t.dateToBeDisplayed,"DD MMM 'YY").diff(E()(e.dateToBeDisplayed,"DD MMM 'YY"))}))).map((function(t){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(n,!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{slots:o(t.slots)})}))},C=function(t){var e=t.startTime,n=t.timezone,r=t.closure,o=t.paymentHrs,i=f.a.now(n).timezone().current.offset,a=E()(e).tz(n).set({millisecond:0,second:0});return r&&a.subtract(r,"hours"),(o=o.map((function(t){if(t.status){var e=E()(t.endTime).tz(n),r=E()(t.startTime).tz(n),o=_({dayINeed:t.day,offset:i});if(t.fullDay?(r=o.clone().set({hour:0,minute:0,second:0,millisecond:0}),e=o.clone().set({hour:23,minute:59,second:59,millisecond:0})):(r=o.clone().set({hour:r.hours(),minute:r.minutes()}),e=o.clone().set({hour:e.hours(),minute:e.minutes()})),r.tz(n).format("L")<=a.tz(n).format("L")&&E()().tz(n).diff(e)<0)return r.tz(n).format("L")===a.tz(n).format("L")&&r.diff(a)>=0?null:e}return null})).filter((function(t){return t})).sort((function(t,e){return t.diff(e)}))).length&&a.diff(o[o.length-1])>=0&&(a=o[o.length-1]),a},R=function(t){return c()(t,"phoneNumber")?"+".concat(t.phoneNumber.countryCode,"-").concat(t.phoneNumber.nationalNumber):c()(t,"countryCode")&&c()(t,"phone")?"+".concat(t.countryCode,"-").concat(t.phone):c()(t,"phone")?"".concat(t.phone):c()(t,"countryCode")&&c()(t,"nationalNumber")?"+".concat(t.countryCode,"-").concat(t.nationalNumber):"N/A"},v=function(t){return(t=t.replace(/^https?:\/\//,"")).includes("".concat(process.env.REACT_APP_AWS_BUCKET_NAME,"."))&&((t=t.split("/"))[0]=process.env.REACT_APP_CDN_NAME,t=t.join("/")),t},G=n(8),h=n.n(G),y=function(t){var e="";return t.addressLines.forEach((function(t){return t?e+=t+", ":""})),"".concat(e," ").concat(t.city,", ").concat(t.country," ")},L=function(t){return"https://www.google.com/maps?z=12&t=m&q=loc:".concat(t.lat,"+").concat(t.lng)},B=function(t,e,n){var r=Math.cos(Math.PI*e.lat/180)*(4e4/360),o=Math.abs(e.lng-t.lng)*r,i=Math.abs(e.lat-t.lat)*(4e4/360);return Math.sqrt(o*o+i*i)<=n},U=function(t,e,n){if(c()(e,"pickUp.isAvailable")&&c()(e,"pickUp.radius"))return e.pickUp;if(c()(t,"pickUp.isAvailable")){var r=h()(t.pickUp);return c()(t,"pickUp.radius")?B(c()(n,"address"),c()(t,"pickUp.location"),c()(t,"pickUp.radius"))?(r.location.lat=c()(n,"address").lat,r.location.lng=c()(n,"address").lng,r.location.fullAddress=c()(n,"address.fullAddress"),r.location.url=L(c()(n,"address"))):(c()(t,"pickUp.location"),c()(t,"pickUp.radius")&&(r.location.url=L(c()(t,"pickUp.location")))):c()(n,"address")&&(r.location={fullAddress:c()(n,"address.fullAddress"),url:L(c()(n,"address")),lat:c()(n,"address").lat,lng:c()(n,"address").lng}),r}return null},g=function(t){var e=t.result;return e.forEach((function(t){t.id=t.code,t.name=t.title})),e},K=function(t,e){return t.filter((function(t){return t.code===e}))[0]},b=function(t,e){return t.filter((function(t){return t.code===e}))[0]},Y=function(t,e){var n=t.filter((function(t){return t.code===e}))[0];return n?n.title:""},H=function(t,e){var n=t.filter((function(t){return t.code===e}))[0];return n?n.title:""},F=function(t,e){return e.filter((function(e){return e.code===t}))[0]._id};n.d(e,"getBookingStatusTitle",(function(){return T})),n.d(e,"getBookingStatusSearchParams",(function(){return I})),n.d(e,"getWeekDate",(function(){return _})),n.d(e,"canCollectPayment",(function(){return S})),n.d(e,"canModifyBookingAdmin",(function(){return A})),n.d(e,"canCancelBookingAdmin",(function(){return m})),n.d(e,"canModifyBooking",(function(){return M})),n.d(e,"canCancelBooking",(function(){return D})),n.d(e,"hostMerchantModifyPrivilege",(function(){return P})),n.d(e,"getModifiedSlots",(function(){return p})),n.d(e,"getExpiryTime",(function(){return C})),n.d(e,"getPhoneNumber",(function(){return R})),n.d(e,"replaceS3withCDN",(function(){return v})),n.d(e,"getFormattedLocation",(function(){return y})),n.d(e,"getLocationUrl",(function(){return L})),n.d(e,"isWithinRadius",(function(){return B})),n.d(e,"getPickUpLocation",(function(){return U})),n.d(e,"formatLocationsList",(function(){return g})),n.d(e,"getCountry",(function(){return K})),n.d(e,"getCity",(function(){return b})),n.d(e,"getCityTitle",(function(){return Y})),n.d(e,"getCountryTitle",(function(){return H})),n.d(e,"getCountryId",(function(){return F}))},,function(t,e){t.exports=n}])}));